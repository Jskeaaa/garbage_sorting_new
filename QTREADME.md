# 垃圾分类 Qt GUI 应用程序

这是一个基于PyQt5的图形用户界面应用程序，可以使用预训练的ResNet-50模型对垃圾图像进行分类。

## 功能特点

- 友好的图形用户界面
- 轻松加载和预测图像
- 实时显示各类别的分类概率
- 支持类激活热图可视化
- 支持GPU加速（如果可用）

## 环境要求

除了原有项目的依赖外，此应用程序还需要安装PyQt5：

```bash
pip install PyQt5>=5.15.0
```

或者，您可以直接使用更新后的requirements.txt文件安装所有依赖：

```bash
pip install -r requirements.txt
```

## 使用方法

1. 确保已经训练好模型，并且模型文件位于`saved_models/model_best.pth`路径
2. 运行应用程序：

```bash
python garbage_classifier_app.py
```

3. 应用程序启动后，使用界面：
   - 点击"打开图像"按钮（或使用Ctrl+O快捷键）选择要分类的图像
   - 点击"开始分类"按钮进行预测
   - 查看结果区域显示的分类结果和概率
   - 可选择打开"显示热图"开关查看类激活映射

## 界面说明

应用程序界面分为左右两部分：

- **左侧**：图像预览区域，显示选择的图像和热图
- **右侧**：分类结果显示区域，包括预测类别和各类别的概率条

底部状态栏显示程序状态和加载进度。

## 错误处理

如果遇到以下问题：

1. **模型加载失败**：
   - 确保模型文件存在于`saved_models/model_best.pth`
   - 确保已安装正确版本的PyTorch和torchvision

2. **图像加载失败**：
   - 确保选择的是有效的图像文件（支持jpg、jpeg、png格式）
   - 确保图像文件未损坏

3. **预测失败**：
   - 查看错误信息，修复相应问题
   - 确保图像文件格式正确

## 系统要求

- Python 3.6+
- PyQt5 5.15.0+
- PyTorch 1.8.0+
- 其他依赖见requirements.txt

## 注意事项

- 首次运行时，程序会加载预训练模型，这可能需要一些时间
- 如果使用GPU，确保有足够的GPU内存用于运行模型
- 图像预处理包括调整大小为224x224像素，这是ResNet-50的标准输入尺寸 